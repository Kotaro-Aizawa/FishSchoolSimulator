# FishSchoolSimulator

ライフゲームの一種で、めだかの群れをシミュレーションします

## 概要
メダカの群れが自然な形で泳ぎ回るシミュレーションゲームです。魚の群れ行動の基本原則である「分離」「整列」「結合」の3つのルールに基づいて、現実的な群れの動きを再現します。

## 事前条件
- 〇×▽マスの格子状のゲームステージを用意します（デフォルトは横1600縦900とします）
- 最初にメダカをランダムに配置します（デフォルトは100匹とします）
- それぞれのメダカは所在地と向きがあります
- ゲーム開始後は、ひたすら魚を眺めます

## 群れ行動の基本ルール（Boidsアルゴリズム）

### 0. 慣性
- 十分重みのある選択肢がないとき、前と同じ動きをする

### 1. 分離（Separation）
- 近くの仲間から離れようとする
- 衝突を避けるための行動
- 各メダカは周囲の一定範囲内の他のメダカから離れる方向に移動

### 2. 整列（Alignment）
- 近くの仲間と同じ方向に泳ごうとする
- 群れの一貫性を保つための行動
- 周囲のメダカの平均的な進行方向に合わせる

### 3. 結合（Cohesion）
- 群れの中心に向かって泳ごうとする
- 群れの結束を保つための行動
- 周囲のメダカの平均位置に向かって移動

## 単位時間処理
メダカは単位時間ごとに以下の処理を行います：

### 移動ルール
1. **視界範囲の設定**: 各メダカは前方・斜め前の3方向1マスずつを視界として認識
2. **群れ行動の計算**: 分離・整列・結合の3つの力を重み付けで合成
3. **移動実行**: 計算された方向に1マス移動（斜め移動も可能・動かないこともできる）
4. **境界処理**: 画面端に到達した場合は反対側から出現（トーラス状の世界）

### 詳細な行動パラメータ（初期値）
- **分離の重み**: 1.5（最も重要）
- **整列の重み**: 1.0
- **結合の重み**: 0.8
- **ランダム性**: 0.1（予測不可能な動きを追加）

ただしシミュレーション中に変更可能とする

### キーボード操作
- **Q/W**: 分離パラメータの減少/増加
- **A/S**: 整列パラメータの減少/増加  
- **Z/X**: 結合パラメータの減少/増加
- **C/B**: ランダムパラメータの減少/増加
- **D/F**: 慣性パラメータの減少/増加
- **R**: パラメータを初期値にリセット
- **I**: 情報表示の切り替え
- **V**: 視界範囲表示の切り替え
- **ESC**: 終了
- **マウスクリック**: メダカを追加

## 技術仕様

### 開発環境
- **言語**: Python 3.13.2
- **ライブラリ**: pygame==2.6.1, numpy==2.3.2
- **OS**: Windows 11
- **文字エンコーディング**: UTF-8

### ファイル構成
```
FishSchoolSimulator/
├── README.md
├── requirements.txt
├── main.py              # メインゲームループ
├── fish.py              # メダカクラス
├── school.py            # 群れ管理クラス
├── world.py             # 世界（ステージ）クラス
├── constants.py         # 定数定義
├── utils.py             # ユーティリティ関数
└── assets/              # 画像・音声ファイル
    ├── fish.png
    └── background.png
```

### クラス設計

#### Fish（メダカ）クラス
- 位置（x, y）
- 方向（dx, dy）
- 体力
- 年齢
- 性別

#### School（群れ）クラス
- メダカのリスト管理
- 群れ行動の計算
- 繁殖処理

#### World（世界）クラス
- ステージの管理
- 境界処理
- 描画処理

## 実行方法
```bash
# 依存関係のインストール
pip install -r requirements.txt

# ゲームの実行
python main.py
```

## パラメータ調整
ゲーム内で以下のパラメータを調整可能：
- メダカの数
- 視界範囲
- 各行動の重み
- 移動速度
- 繁殖確率

## 今後の拡張予定
- 捕食者の追加
- 餌のシステム
- 環境要因（水温、水流）
- 遺伝的アルゴリズムによる進化
- 3D化

